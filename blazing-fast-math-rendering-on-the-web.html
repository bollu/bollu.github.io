<!DOCTYPE html><meta charset='UTF-8'><html><head><link rel='alternate' type='application/rss+xml' href='feed.rss' title='A universe of sorts'/><link rel='stylesheet' href='katex/katex.min.css'    integrity='sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X'    crossorigin='anonymous'><!-- The loading of KaTeX is deferred to speed up page rendering --><link rel='stylesheet' href='prism/prism.css'><title> A Universe of Sorts </title><style>@font-face {font-family: 'Blog Mono'; src: url('/static/iosevka-fixed-extended.ttf');}@font-face {font-family: 'Blog Sans'; src: url('/static/Exo2-Regular.ttf');}@font-face {font-family: 'Blog Serif'; src: url('/static/Revans-Regular.ttf');}html { font-size: 100%; }html,body { text-size-adjust: none; -webkit-text-size-adjust: none; -moz-text-size-adjust: none; -ms-text-size-adjust: none; } body { background-color: #FFFFFF; color: #000000;  font-family: 'Blog Serif', sans-serif; font-size: 18px; line-height: 1.4em;  max-width: 100%; overflow-x: hidden; }
h1, h2, h3, h4, h5 { font-family: 'Blog Sans' }img { display:block; width: 100%; max-width: 800px; height: auto }.container { overflow-x: auto; overflow-y: hidden;  max-width: 80ex; text-align: justify; }@media (max-width: 480px) { .container { margin-left: 5%; margin-right: 5%; } body { font-size: 30px; } }@media (max-width: 1024px) { .container { margin-left: 5%; margin-right: 5%; } body { font-size: 30px; } }@media (min-width: 1024px) { .container { margin-left: 25%; margin-right: 20%; } }.image { }
a:hover { color: #1a73e8; text-decoration: underline;  }
a { color: #1a73e8; text-decoration: none; }
a:visited { color: #1a73e8; text-decoration: none; }
a:active { color: #1a73e8; text-decoration: none; }

blockquote { margin-left: 0px; margin-right: 0px; } pre, .latexblock, blockquote { border-left-color:#BBB;  border-left-style: solid;      border-left-width: 5px; }pre, blockquote { padding-left: 10px; }
pre { font-family: 'Blog Mono', monospace; font-size: 90%;  }pre {  overflow-x: auto; }.latexblock, blockquote, pre { margin-top: 10px; margin-bottom: 10px; padding-bottom: 5px; padding-top: 5px; background-color: #FFFFFF; }.latexblock { line-height: 1em }
pre, kbd, samp, tt{ font-family:'Blog Mono',monospace; }.inline { white-space: nowrap; background:#efefef; }ul, ol { list-style-position: inside; padding-left: 0; }ul { list-style-type: disclosure-closed; }</style></head><body><div class='container'><h2><a id=blazing-fast-math-rendering-on-the-web href='#blazing-fast-math-rendering-on-the-web'> § </a><span class='centered'> Blazing fast math rendering on the web</h2>
<span class='centered'>So, I've shifted the blog to be static-site-generated using a
<span class='centered'>static-site-generator written by yours truly. The code clocks in at around a
<span class='centered'>thousand lines of C++:
<ul><li><span class='centered'><span class='centered'> <a href=https://github.com/bollu/bollu.github.io/tree/master/builder/builder.cpp><span class='centered'>bollu/bollu.github.io/builder/builder.cpp</a></li></ul>
<span class='centered'>What did I gain?
<ol><li><span class='centered'><span class='centered'> My generator is a real compiler, so I get errors on math and markdown<span class='centered'>malformation.</li><li><span class='centered'><span class='centered'> I can write math that <i><span class='centered'>loads</i> instantly on your browser, using no MathJax,<span class='centered'>KaTeX or any client side processing, <i><span class='centered'>nor</i> the need to fetch images, which looks like this:</li></ol>
<div class='latexblock'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≡</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mo>∫</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant="normal">∞</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant="normal">∞</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
h(x) \equiv 
\begin{cases} 
\int_{i=0}^\infty f(x) g(x) dx &amp; x &gt; 0 \\
\sum_{i=0}^\infty f(x) + g(x) &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8592920000000001em;"><span style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35582em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">otherwise</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div>
<h4><a id=why href='#why'> § </a><span class='centered'> Why?</h4>
<span class='centered'>My blog is a <a href=https://github.com/bollu/bollu.github.io/blob/master/README.md><span class='centered'>single 9000 line markdown file</a>,
<span class='centered'>rendered as a <i><span class='centered'>single HTML page</i>, so I 
<span class='centered'><i><span class='centered'>need it to compile fast, render fast, render beautiful</i>. 
<span class='centered'>Existing tools compromise on one or the other.
<h4><a id=no-seriously-why-a-single-markdown-file href='#no-seriously-why-a-single-markdown-file'> § </a><span class='centered'> No seriously, why a single markdown file?</h4>
<span class='centered'>I need a single file to edit, so I can rapidly jot down new ideas. This is 
<span class='centered'>the essence of why I'm able to log most of what I study: 
<span class='centered'><i><span class='centered'>because it's seamless</i>.
<span class='centered'>Far more importantly, it provides <i><span class='centered'><i><span class='centered'>spatio-temporal locality</i></i>. I add things
<span class='centered'>in chronological order to tbe blog, as I learn thing. If I need to recall
<span class='centered'>something I had studied, go to that location in the blog 
<span class='centered'><i><span class='centered'>based on a sense of when</i>. 
<span class='centered'>When I do get to a location I want, the scrollbar gives me a sense of 
<span class='centered'><i><span class='centered'>where I am</i> in the file.  this is important to me, since it hepls me reason
<span class='centered'>spatially about what i know and what I've learnt. It's someting I love about
<span class='centered'>books, and deeply miss when navigtaing the web.I'm determined to keep this
<span class='centered'>spatio-temporal locality on my little slice of the internet.
<h4><a id=why-is-this-awful href='#why-is-this-awful'> § </a><span class='centered'> Why is this awful?</h4>
<span class='centered'>As elegant as this model is to <i><span class='centered'>edit</i>, it's awful for browsers to render. The
<span class='centered'>file used to take on the order of minutes for all the math to finish
<span class='centered'>rendering. MathJax (and KaTeX) painfully attempt to render each
<span class='centered'>math block. As they do, the page jumps around until everything has settled.
<span class='centered'>As this is happening, your CPU throttles, your lap or hand gets warm,
<span class='centered'>and the page is stuck. Clearly not great UX.
<span class='centered'>I still want math. What do I do?  The solution is easy: Approximate the math
<span class='centered'>rendering using ASCII/UTF-8 characters!  There are tools that do this ---
<span class='centered'><a href=http://hevea.inria.fr/><span class='centered'><code class='inline'>hevea</code></a> is one of them. Unfortunately, there is no
<span class='centered'>markdown-based-blogging-platform that uses this, so I <i><span class='centered'>had</i> to write my own.
<h4><a id=the-cure href='#the-cure'> § </a><span class='centered'> The cure</h4>
<span class='centered'>The solution is easy. I wrote the tool. The page you're reading it
<span class='centered'>is rendered using the tool. All the math renders in under a second because
<span class='centered'>it's nothing crazy, it's just text and tables which browsers know how to
<span class='centered'>render. No JavaScript necessary. snappy performance. Whoo!
<h4><a id=the-details-writing-my-own-markdown-to-html-transpiler href='#the-details-writing-my-own-markdown-to-html-transpiler'> § </a><span class='centered'> The details: Writing my own Markdown to HTML transpiler.</h4>
<span class='centered'>the final transpiler clocks in at <code class='inline'>1300Loc</code> of C++,
<span class='centered'>which is very small for a feature-complete markdown-to-HTML piece of code
<span class='centered'>that's blazing fast, renders math correctly, and provides error messages.
<h4><a id=quirks-fixed-features-gained href='#quirks-fixed-features-gained'> § </a><span class='centered'> Quirks fixed, features gained.</h4>
<span class='centered'>I got quite a bit "for free" as I wrote this, fixing mild annoyances
<span class='centered'>and larger pain points around using github + markdown for publishing on
<span class='centered'>the web:
<ul><li><span class='centered'><span class='centered'> I really don't want tables, but I do want the ability to write vertical bars <span class='centered'><code class='inline'>|</code> freely in my text. Unfortunately, github <i><span class='centered'>insists</i> that those are tables,<span class='centered'>and completely wrecks rendering.</li></ul>
<ul><li><span class='centered'><span class='centered'> I get line numbers in code blocks now, which Github Flavoured Markdown<span class='centered'>did not have.</li></ul>
<ul><li><span class='centered'><span class='centered'> I get error messages on incorrectly closed bold/italic/code blocks, using<span class='centered'>heuristics that prevent them from spanning across too many lines.</li></ul>
<ul><li><span class='centered'><span class='centered'> I get error messages on broken latex, since all my latex passes through<span class='centered'><code class='inline'>hevea</code>. This is awesome, since I no longer need to refresh my browser,<span class='centered'>wait for mathjax to load, go make myself tea (remember that mathjax was slow?),<span class='centered'>and then come back to see the errors.</li></ul>
<ul><li><span class='centered'><span class='centered'> I can get error messages if my internal document links are broken. To be<span class='centered'>fair, my tool doesn't currently give me these errors, but it can (and soon<span class='centered'>will).</li></ul>
<ul><li><span class='centered'><span class='centered'> In general, I get <i><span class='centered'>control</i>, which was something I did not have with<span class='centered'>rendering directly using Github, or using someone else's tool.</li></ul>
<h4><a id=choice-of-language href='#choice-of-language'> § </a><span class='centered'> Choice of language</h4>
<span class='centered'>I choose to write this in C-style-C++, primarily because I wanted the tool
<span class='centered'>to be fast, and I'd missed writing C++ for a while. I really enjoy how
<span class='centered'>stupid-simple C style C++ turns out to be: the C++ papers over some of C's
<span class='centered'>annoyances (like formatted output for custom types), while still preserving the
<span class='centered'>KISS feeling of writing C++.
<span class='centered'><i><span class='centered'><i><span class='centered'>Why not Rust?</i></i> I freely admit that rust might have been a sane choice as
<span class='centered'>well.  unfortunately, asking rust to treat UTF-8 string as a "ball of bytes" is
<span class='centered'>hard, when it's stupidly easy with C. Plus, I wanted to use arena-style-allocation
<span class='centered'>where I make <i><span class='centered'>huge</i> allocations in one go and then don't think about memory,
<span class='centered'>something that I don't have control over in Rust. I don't have any segfaults
<span class='centered'>(yet, perhaps), thanks to UBSAN and ASAN. I find Rust to have more impedance
<span class='centered'>than C on small applications, and this was indeed small.
<h4><a id=performance href='#performance'> § </a><span class='centered'> Performance</h4>
<span class='centered'>Everything <i><span class='centered'>except</i> the latex to HTML is blazing fast. Unfortunately,
<span class='centered'>calling <code class='inline'>hevea</code> is slow, so I implemented a caching mechanism to make using
<span class='centered'><code class='inline'>hevea</code> not-slow. <code class='inline'>hevea</code> does not have an API, so I need to <code class='inline'>fork</code> and
<span class='centered'>talk to its process which is understandably flow. I built a "key-value-store"
<span class='centered'>(read: serialize data into a file) with the stupidly-simple approach of writing
<span class='centered'>an append-only log into a file. <code class='inline'>hevea</code> is a pure function conceptally,
<span class='centered'>since on providing the same latex input it's going to produce the same HTML
<span class='centered'>output, so it's perfectly safe to cache it:
<pre><code><span class="token keyword">const</span> <span class="token keyword">char</span> DB_PATH<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"./blogcache.txt"</span><span class="token punctuation">;</span>
unordered_map<span class="token operator">&lt;</span>ll<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">></span> G_DB<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">loadDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    G_DB <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    FILE <span class="token operator">*</span>f <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>DB_PATH<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ll k<span class="token punctuation">,</span> len<span class="token punctuation">;</span>
        <span class="token function">fread</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>k<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ll<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">feof</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token function">fread</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>len<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ll<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token keyword">char</span> <span class="token operator">*</span>buf <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">calloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">,</span> len <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fread</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">,</span> len<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
    <span class="token function">fclose</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">lookup_key</span><span class="token punctuation">(</span>ll k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    unordered_map<span class="token operator">&lt;</span>ll<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">></span><span class="token operator">::</span>iterator it <span class="token operator">=</span> G_DB<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>it <span class="token operator">==</span> G_DB<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">return</span> it<span class="token operator">-></span>second<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">store_key_value</span><span class="token punctuation">(</span><span class="token keyword">const</span> ll k<span class="token punctuation">,</span> KEEP <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>v<span class="token punctuation">,</span> <span class="token keyword">const</span> ll len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>G_DB<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    G_DB<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token function">make_pair</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token function">strdup</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    FILE <span class="token operator">*</span>f <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>DB_PATH<span class="token punctuation">,</span> <span class="token string">"ab"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>f <span class="token operator">!=</span> <span class="token keyword">nullptr</span> <span class="token operator">&amp;&amp;</span> <span class="token string">"unable to open DB file"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>k<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ll<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>len<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ll<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fwrite</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">,</span> len<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fclose</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id=for-the-future href='#for-the-future'> § </a><span class='centered'> For the future</h4>
<span class='centered'>I plan to rip out <code class='inline'>hevea</code> and write my own <code class='inline'>latex -> HTML</code> converter for
<span class='centered'>the <i><span class='centered'>subset of LaTeX I actually use</i>. <code class='inline'>hevea</code>'s strength is its downfall:
<span class='centered'>It can handle all of LaTeX, which means it's really slow. If I can concentrate
<span class='centered'>on a small subset, I don't need to play caching tricks, and I can likely
<span class='centered'>optimise the layout further for my use-cases.
<span class='centered'>I also want colored error messages, because who doesn't?
<span class='centered'>I'll probably gradually improve my static site generator over time. Once it's
<span class='centered'>at a level of polish where I'm happy with it, I'll spin it out as a separate
<span class='centered'>project.
<h4><a id=conclusions href='#conclusions'> § </a><span class='centered'> Conclusions</h4>
<span class='centered'>Am I glad I did it? Yes, purely because my chunk of the internet aligns with
<span class='centered'>how I want it to be, and that makes me <span class='latexinline'><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span> more happy.
<span class='centered'>I think of it as an investment into future me, since I can extend the
<span class='centered'>markdown and the transpiler in the way <i><span class='centered'>I</i> want it to be.
<script src="https://utteranc.es/client.js"        repo="bollu/bollu.github.io"        issue-term="pathname"        label="question"        theme="github-light"        crossorigin="anonymous"        async></script></container></body></html>